decision_asteroid_habitat = {
	owned_planets_only = no

	prerequisites = {
		"tech_asteroid_habitat"
	}

	enactment_time = 0
	resources = {
		category = decisions
		cost = {
			influence = 100
			alloys = 1000
		}
	}

	potential = {
        is_asteroid = yes
        OR = {
            is_planet_class = "pc_asteroid"
            is_planet_class = "pc_ice_asteroid"
            is_planet_class = "pc_rare_crystal_asteroid"
        }
		NOT = { has_modifier = "terraforming_candidate" }
	}

    effect = {
        set_planet_flag = asteroid_habitat
        add_modifier = { modifier = "asteroid_habitat" days = -1 }

	    ## specialization

	    if = {
	        limit = {
                OR = {
                    has_deposit = d_minerals_1
                    has_deposit = d_minerals_2
                    has_deposit = d_minerals_3
                    has_deposit = d_minerals_4
                    has_deposit = d_minerals_5
                    has_deposit = d_minerals_6
                    has_deposit = d_minerals_7
                    has_deposit = d_minerals_8
                    has_deposit = d_minerals_9
                    has_deposit = d_minerals_10
                }
            }
            set_planet_flag = asteroid_habitat_mining
	    }

	    if = {
	        limit = { has_deposit = d_exotic_gases_1 }
            set_planet_flag = asteroid_hab_gas_1
	    }
	    if = {
	        limit = { has_deposit = d_exotic_gases_2 }
            set_planet_flag = asteroid_hab_gas_2
	    }
	    if = {
	        limit = { has_deposit = d_exotic_gases_3 }
            set_planet_flag = asteroid_hab_gas_3
	    }
	    if = {
	        limit = { has_deposit = d_exotic_gases_4 }
            set_planet_flag = asteroid_hab_gas_4
	    }
	    if = {
	        limit = { has_deposit = d_exotic_gases_5 }
            set_planet_flag = asteroid_hab_gas_5
	    }

	    if = {
	        limit = { has_deposit = d_rare_crystals_1 }
            set_planet_flag = asteroid_hab_crystal_1
	    }
	    if = {
	        limit = { has_deposit = d_rare_crystals_2 }
            set_planet_flag = asteroid_hab_crystal_2
	    }
	    if = {
	        limit = { has_deposit = d_rare_crystals_3 }
            set_planet_flag = asteroid_hab_crystal_3
	    }
	    if = {
	        limit = { has_deposit = d_rare_crystals_4 }
            set_planet_flag = asteroid_hab_crystal_4
	    }
	    if = {
	        limit = { has_deposit = d_rare_crystals_5 }
            set_planet_flag = asteroid_hab_crystal_5
	    }

	    if = {
	        limit = { has_deposit = d_volatile_motes_1 }
            set_planet_flag = asteroid_hab_motes_1
	    }
	    if = {
	        limit = { has_deposit = d_volatile_motes_2 }
            set_planet_flag = asteroid_hab_motes_2
	    }
	    if = {
	        limit = { has_deposit = d_volatile_motes_3 }
            set_planet_flag = asteroid_hab_motes_3
	    }
	    if = {
	        limit = { has_deposit = d_volatile_motes_4 }
            set_planet_flag = asteroid_hab_motes_4
	    }
	    if = {
	        limit = { has_deposit = d_volatile_motes_5 }
            set_planet_flag = asteroid_hab_motes_5
	    }

        clear_deposits = yes

        ## changing planet class

	    if = {
	        limit = { is_planet_class = "pc_asteroid" }
	        change_pc = "pc_asteroid_habitat"
	    }
	    if = {
	        limit = { is_planet_class = "pc_ice_asteroid" }
	        change_pc = "pc_ice_asteroid_habitat"
	    }
	    if = {
	        limit = { is_planet_class = "pc_rare_crystal_asteroid" }
	        change_pc = "pc_rare_crystal_asteroid_habitat"
	    }

	    ## adding deposits

	    if = {
	        limit = { has_planet_flag = asteroid_hab_gas_1 }
	        add_deposit = d_hab_gas_1
	    }
	    if = {
	        limit = { has_planet_flag = asteroid_hab_gas_2 }
	        add_deposit = d_hab_gas_2
	    }
	    if = {
	        limit = { has_planet_flag = asteroid_hab_gas_3 }
	        add_deposit = d_hab_gas_3
	    }
	    if = {
	        limit = { has_planet_flag = asteroid_hab_gas_4 }
	        add_deposit = d_hab_gas_4
	    }
	    if = {
	        limit = { has_planet_flag = asteroid_hab_gas_5 }
	        add_deposit = d_hab_gas_5
	    }

	    if = {
	        limit = { has_planet_flag = asteroid_hab_crystal_1 }
	        add_deposit = d_hab_crystal_1
	    }
	    if = {
	        limit = { has_planet_flag = asteroid_hab_crystal_2 }
	        add_deposit = d_hab_crystal_2
	    }
	    if = {
	        limit = { has_planet_flag = asteroid_hab_crystal_3 }
	        add_deposit = d_hab_crystal_3
	    }
	    if = {
	        limit = { has_planet_flag = asteroid_hab_crystal_4 }
	        add_deposit = d_hab_crystal_4
	    }
	    if = {
	        limit = { has_planet_flag = asteroid_hab_crystal_5 }
	        add_deposit = d_hab_crystal_5
	    }

	    if = {
	        limit = { has_planet_flag = asteroid_hab_motes_1 }
	        add_deposit = d_hab_mote_1
	    }
	    if = {
	        limit = { has_planet_flag = asteroid_hab_motes_2 }
	        add_deposit = d_hab_mote_2
	    }
	    if = {
	        limit = { has_planet_flag = asteroid_hab_motes_3 }
	        add_deposit = d_hab_mote_3
	    }
	    if = {
	        limit = { has_planet_flag = asteroid_hab_motes_4 }
	        add_deposit = d_hab_mote_4
	    }
	    if = {
	        limit = { has_planet_flag = asteroid_hab_motes_5 }
	        add_deposit = d_hab_mote_5
	    }

        set_planet_size = 3
	}

	ai_weight = {
		weight = 1
	}
}
