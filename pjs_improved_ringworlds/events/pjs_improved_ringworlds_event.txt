namespace = pjs_improved_ringworlds

event = {
	id = pjs_improved_ringworlds.1

	hide_window = yes
	is_triggered_only = yes

	immediate = {
        every_planet = {
            limit = {
                OR = {
                    has_planet_flag = awakened_scientists_start
                    has_planet_flag = ring_world_start
                }
            }

            change_pc = "pc_ringworld_habitable"

            while = {
                count = 10
                remove_district = district_generator
                remove_district = district_generator_uncapped
                remove_district = district_mining
                remove_district = district_mining_uncapped
                remove_district = district_farming
                remove_district = district_farming_uncapped
            }

            if = {
                limit = {
                    owner = {
                        is_machine_empire = yes
                        NOT = { has_valid_civic = civic_machine_assimilator }
                        NOT = { has_valid_civic = civic_machine_servitor }
                    }
                }

                while = {
                    count = 9
                    add_district = district_ringworld_v2_generator
                }
            }

            if = {
                limit = {
                    owner = {
                        OR = {
                            is_regular_empire = yes
                            is_hive_empire = yes
                            has_valid_civic = civic_machine_assimilator
                            has_valid_civic = civic_machine_servitor
                        }
                    }
                }

                while = {
                    count = 9
                    add_district = district_ringworld_v2_rural
                }
            }

            while = {
                count = 10
                create_pop = { species = owner_main_species }
            }
        }
	}
}

event = {
	id = pjs_improved_ringworlds.2

	hide_window = yes
	is_triggered_only = yes

	immediate = {
		set_global_flag = ringworld_districts_v2
	}
}
